function Yt(t){return typeof t!="string"?{valid:!1,error:`expected string instead of ${L(t)}`}:t===""?{valid:!1,error:"cannot import empty path"}:{valid:!0}}function ft(t){let e=[],r=[];for(let[n,o]of t.entries()){let s=Yt(o);if(!s.valid){r.push({path:`.[${n}]`,message:`${s.error}, ignoring import`});continue}e.push(o)}return{result:e,errors:r}}function Gt(t){return t===""?{result:[],errors:[{path:"",message:"cannot import empty path, ignoring import"}]}:typeof t=="string"?{result:[t],errors:[]}:Array.isArray(t)?ft(t):{result:[],errors:[{path:"",message:`expected string or string array (string[]) instead of ${L(t)}`}]}}function B(t){if(!pt(t))return{result:{},errors:[{path:"",message:`expected a plain object instead of ${L(t)}`}]};let e=[],r=[];for(let[n,o]of Object.entries(t)){if(typeof o!="string"){r.push({path:M(n),message:`expected string instead of ${L(o)}`});continue}e.push([n,o])}return{result:Object.fromEntries(e),errors:r}}function F(t){if(t==="")return{result:{import:[],translations:{}},errors:[{path:"",message:"cannot import empty path, ignoring import"}]};if(typeof t=="string")return{result:{import:[t],translations:{}},errors:[]};if(Array.isArray(t)){let a=ft(t),c=a.errors;return{result:{import:a.result,translations:{}},errors:c}}if(!pt(t))return{result:{import:[],translations:{}},errors:[{path:"",message:"invalid type"}]};let e=[],r=Object.hasOwn(t,"import"),n=Object.hasOwn(t,"translations"),o=(()=>{if(!r)return[];let a=Gt(t.import);return e.push(...a.errors.map(({path:c,message:u})=>({path:G(".import",c),message:u}))),a.result})(),s=(()=>{if(!n)return{};let a=B(t.translations);return e.push(...a.errors.map(({path:c,message:u})=>({path:G(".translations",c),message:u}))),a.result})();return r||n?{result:{import:o,translations:s},errors:e}:{result:{import:[],translations:{}},errors:[{path:"",message:'invalid object, the object must have "import" or "translations" keys'}]}}function k(t){let e=[],r=[],n=[];for(let[o,s]of Object.entries(t)){let a;try{a=new Intl.Locale(o)}catch{e.push({path:M(o),message:`invalid locale "${o}", it will be ignored`});continue}let{baseName:c}=a;if(c!==o)if(t[c]){e.push({path:M(o),message:`invalid locale "${o}", it also conflicts with correct locale "${c}", it will be ignored`});continue}else r.push({path:M(o),message:`invalid locale "${o}", fixed to locale "${c}"`});let u=F(s);if(u.errors.length){let m=M(o);e.push(...u.errors.map(({path:l,message:f})=>({path:G(m,l),message:f})))}n.push([c,u.result])}return{result:Object.fromEntries(n),warnings:r,errors:e}}var L=t=>t==null?String(t):typeof t,pt=t=>t?.constructor===Object,M=t=>/^[a-z][a-z\d]*$/i.test(t)?`.${t}`:`.[${JSON.stringify(t)}]`,G=(t,e)=>t+(e==="."||e.startsWith(".[")?e.substring(1):e);var Bt=Object.freeze({importTranslations:()=>(console.error("importLanguage not implemented"),Promise.resolve({})),importI18nJson:()=>(console.error("importLanguage not implemented"),Promise.resolve({}))}),N=Object.seal({...Bt});function dt(t){typeof t?.importTranslations=="function"&&(N.importTranslations=t.importTranslations),typeof t?.importI18nJson=="function"&&(N.importI18nJson=t.importI18nJson)}async function Qt(t,e){let r=new URL(t,e),o=await(await fetch(r)).json(),s=B(o);return s.errors.forEach(a=>console.error("Error on %s::%s, %s",r.href,a.path,a.message)),s.result}async function Xt(t,e){let r=new URL(t,e),o=await(await fetch(r)).json(),s=k(o);return s.errors.forEach(a=>console.error("Error on %s::%s, %s",r.href,a.path,a.message)),s.warnings.forEach(a=>console.warn("Warning on %s::%s, %s",r.href,a.path,a.message)),s.result}dt({importTranslations:Qt,importI18nJson:Xt});function*gt(t){let e=t;for(;e!=null;){yield e;let{parentNode:r,parentElement:n}=e;if(r instanceof ShadowRoot){e=r.host;continue}if(r instanceof Document||n==null)return;e=n}}function*A(t){let e=t;for(;e!=null;){yield e;let{parentNode:r,parentElement:n,assignedSlot:o}=e;if(o){e=o;continue}if(r instanceof ShadowRoot){e=r.host;continue}if(r instanceof Document||n==null)return;e=n}}function ht(t){let e=t.ownerDocument.defaultView??globalThis;return e.navigator?(e.navigator.languages||[e.navigator.language])[0]:Intl.DateTimeFormat().resolvedOptions().locale}function Zt(t,e){return t===t.ownerDocument.documentElement?ht(t):t.parentNode instanceof ShadowRoot?T(t.parentNode.host):T(t.parentElement)}function T(t){if(t==null)return navigator.language;for(let e of A(t)){let r=e.getAttribute("lang");if(r)try{let n=new Intl.Locale(r),{language:o,region:s}=n;return s==null?o:`${o}-${s}`}catch{return Zt(e,r)}}return ht(t)}var P=class{constructor(e=[]){for(let[r,n]of e)this.set(r,n)}get size(){return v(this).keySet.size}delete(e){let{keySet:r,refWeakMap:n}=v(this),o=n.get(e);return o?(r.delete(o.ref),n.delete(e),!0):!1}[Symbol.iterator](){return this.entries()}*entries(){let{refWeakMap:e}=v(this);for(let r of this.keys()){let n=e.get(r);n&&(yield[r,n.value])}}forEach(e,r){for(let[n,o]of this.entries())e.call(r,o,n,this)}get(e){return v(this).refWeakMap.get(e)?.value}has(e){return v(this).refWeakMap.has(e)}*keys(){let{keySet:e}=v(this),r=Array.from(e);for(let n of r){let o=n.deref();if(!o){e.delete(n);continue}yield o}}set(e,r){let{keySet:n,refWeakMap:o}=v(this),s=o.get(e);if(s!==void 0)return s.value=r,this;let a=new WeakRef(e);return o.set(e,{ref:a,value:r}),n.add(a),this}*values(){for(let[,e]of this.entries())yield e}},E=class{constructor(e=[]){for(let r of e)this.add(r)}get size(){return v(this).keySet.size}delete(e){let{keySet:r,refWeakMap:n}=v(this),o=n.get(e);return o?(r.delete(o.ref),n.delete(e),!0):!1}[Symbol.iterator](){return this.entries()}*entries(){for(let e of this.keys())yield e}forEach(e,r){for(let n of this.entries())e.call(r,n,this)}has(e){return v(this).refWeakMap.has(e)}*keys(){let{keySet:e}=v(this),r=Array.from(e);for(let n of r){let o=n.deref();if(!o){e.delete(n);continue}yield o}}add(e){let{keySet:r,refWeakMap:n}=v(this);if(n.has(e))return this;let o=new WeakRef(e);return n.set(e,{ref:o,value:!0}),r.add(o),this}*values(){for(let e of this.keys())yield e}},v=(()=>{let t=new WeakMap;function e(n){let a={keySet:new Set,refWeakMap:new WeakMap};return t.set(n,a),a}function r(n){return t.get(n)??e(n)}return r})();var O=new P,bt=Symbol("ElementLangObserverData"),D=new WeakMap;var te="lang-change-dispatched",I=class{constructor(e){this[bt]={callback:e}}observe(e){oe(e,this)}unobserve(e){se(e,this)}},ee=Object.freeze({attributes:!0,attributeFilter:["lang"],subtree:!0});function re(t){let e=new Set,r=new Set,n=new Set;for(let s of t){let a=s.target.getRootNode();n.add(a);let c=O.get(a)?.observingElements;c&&c.forEach(u=>{if(r.has(u))return;r.add(u);let m=D.get(u);if(!m)return;let l=m.currentLang,f=T(u);f!==l&&(m.currentLang=f,m.observers.forEach(g=>{g[bt].callback([{target:u,causingElement:s.target,previousLanguage:l,language:f}])}),e.add(u))})}let o=new CustomEvent(te,{detail:{triggeredNodes:Array.from(e)}});for(let s of n)s.dispatchEvent(o)}function ne(t){let e=new MutationObserver(re);return e.observe(t,ee),e}function yt(t,e){let r=O.get(t);if(r?r.observingElements.add(e):O.set(t,{observer:ne(t),observingElements:new E([e]),targetNode:new WeakRef(t)}),t instanceof ShadowRoot){let n=t.host;yt(n.getRootNode(),e)}}function oe(t,e){let r=D.get(t);if(r){r.observers.add(e);return}D.set(t,{currentLang:T(t),observers:new Set([e])});let n=t.getRootNode();yt(n,t)}function se(t,e){let r=D.get(t)?.observers;if(r&&(r.delete(e),!(r.size>0))){D.delete(t);for(let[n,o]of O.entries()){let{observingElements:s,observer:a}=o;s.delete(t),s.size<=0&&(a.disconnect(),O.delete(n))}}}function vt(t){if(t instanceof HTMLElement)return t.translate;if(t==null)return!1;for(let e of A(t)){if(e instanceof HTMLElement)return e.translate;let r=e.getAttribute("translate");if(r!=null){if(r===""||r==="yes")return!0;if(r==="no")return!1}}return!0}var Tt=(t,e)=>N.importTranslations(t,e),wt=(t,e)=>N.importI18nJson(t,e);var ae=Object.freeze({}),ie=Object.freeze({languages:ae,location:""});function ce(t){let e=k(t.languages);return e.errors.forEach(r=>console.error("Error on %s::%s, %s",t.location,r.path,r.message)),e.warnings.forEach(r=>console.warn("Warning on %s::%s, %s",t.location,r.path,r.message)),{location:t.location,languages:structuredClone(e.result)}}var Q=new WeakMap;function xt(t){let e=Q.get(t);if(e)return e;let r={};return Q.set(t,r),r}var ue=async(t,e)=>{let r=xt(t);if(r[e])return r[e];let n=t.data.languages[e];if(!n)return{};if(!Array.isArray(n.import)||n.import.length<=0)return n.translations;let o=n.import.map(c=>Tt(c,t.data.location)),a=(await Promise.all(o)).reduce((c,u)=>({...c,...u}));return r[e]={...a,...n.translations},r[e]},le={loadTranslations(t){this.data=ce(t),Q.delete(this)},async translationsFromLanguage(t){if(typeof t=="string")return await this.translationsFromLanguage(new Intl.Locale(t));let e=xt(this);if(e[t.baseName])return e[t.baseName];let r=[t.baseName],n=t.language;if(t.region!=null){let c=`${n}-${t.region}`;r.includes(c)||r.push(c)}r.includes(n)||r.push(n);let o=r.reverse().map(c=>ue(this,c)),a=(await Promise.all(o)).reduce((c,u)=>({...c,...u}));return e[t.baseName]=a,a},data:ie};function C(){return Object.create(le)}var me=C(),fe=Object.freeze({store:me}),X=new WeakMap;var j=function(t){return X.has(t)},R=(t,e)=>{X.set(t,e)},$=function*(t){for(let e of gt(t)){let r=X.get(e);r&&(yield{store:r,element:e})}yield fe};var i={normal:0,capture:1,capture_expr:2,capture_expr_sep:3,regex:4,sq_string:5,dq_string:6,bt_string:7,escape:8,previous:9,previous_ignore:10},p=t=>t.charCodeAt(0),pe=(()=>{let t=[];return t[i.normal]=i.normal,t[i.capture]=i.capture_expr,t[i.capture_expr]=i.capture_expr,t[i.capture_expr_sep]=i.previous_ignore,t[i.regex]=i.regex,t[i.sq_string]=i.sq_string,t[i.dq_string]=i.dq_string,t[i.bt_string]=i.bt_string,t[i.escape]=i.previous,t})(),de=(()=>{let t=[];return t[p("{")]=i.capture,t})(),ge=(()=>{let t=[];return t[p("}")]=i.previous,t[p("/")]=i.regex,t[p("'")]=i.sq_string,t[p('"')]=i.dq_string,t[p("`")]=i.bt_string,t[p("\\")]=i.escape,t[p("	")]=i.capture,t[p(" ")]=i.capture,t[p(`
`)]=i.capture,t[p("|")]=i.capture_expr_sep,t})(),he=(()=>{let t=[];return t[p("\\")]=i.previous_ignore,t[p("	")]=i.previous_ignore,t[p(" ")]=i.previous_ignore,t[p("|")]=i.previous_ignore,t[p(`
`)]=i.previous_ignore,t[p("}")]=i.previous_ignore,t})(),be=(()=>{let t=[];return t[p("/")]=i.previous,t[p("\\")]=i.escape,t})(),ye=(()=>{let t=[];return t[p("'")]=i.previous,t[p("\\")]=i.escape,t})(),ve=(()=>{let t=[];return t[p('"')]=i.previous,t[p("\\")]=i.escape,t})(),Te=(()=>{let t=[];return t[p("`")]=i.previous,t[p("\\")]=i.escape,t})(),kt=(()=>{let t=[];return t[i.normal]=de,t[i.capture]=ge,t[i.capture_expr]=he,t[i.capture_expr_sep]=[],t[i.regex]=be,t[i.sq_string]=ye,t[i.dq_string]=ve,t[i.bt_string]=Te,t[i.escape]=[],t})();function W(t){let e=i.normal,r=kt[e],n={tokens:[]},o={parentNode:n,start:0,end:0,type:i.normal,childTokens:[]},s=l=>{e=l,r=kt[e]},a=l=>l===n,c=l=>{if(s(o.parentNode.type??i.normal),o.type===i.escape){let{parentNode:g}=o;if(a(g)){o=n.tokens.pop();return}o=g;return}o.end=l+1;let{parentNode:f}=o;if(a(f)){f.tokens.push(o),o={parentNode:f,start:l+1,end:l+1,type:i.normal,childTokens:[]};return}f.childTokens.push(o),o=f},u=t.length;for(let l=0;l<u;l++){let f=t.charCodeAt(l),g=r[f]??pe[e];if(!(g==null||g===e)){if(g===i.previous){c(l);continue}if(g===i.previous_ignore){c(l-1),l--;continue}if(e===i.normal){if(t.charCodeAt(l+1)===f){l++;continue}o.end=l,o.end>o.start&&n.tokens.push(o),o={parentNode:n,start:l,end:l,type:g,childTokens:[]}}else o={parentNode:o,start:l,end:l,type:g,childTokens:[]};s(g)}}o.end=t.length,o.end>o.start&&n.tokens.push(o);let m=({start:l,end:f,type:g,childTokens:lt})=>{let mt=t.substring(l,f),Jt=g===i.normal?mt.replaceAll("{{","{"):mt;return{start:l,end:f,type:g,text:Jt,childTokens:lt.map(m)}};return{key:t,tokens:n.tokens.map(m)}}function d(t){return typeof t=="string"&&t.trim()===t&&!isNaN(Number(t))&&!isNaN(parseFloat(t))}function Et(t){return typeof t=="string"&&/^[+-]?[0-9]+$/.test(t)}function h(t){if(typeof t!="string")return NaN;let e=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d)/;return t.match(e)?Date.parse(t):NaN}var b=(()=>{let t=null;return function(){return t===null&&(t=Date.now(),requestAnimationFrame(()=>{t=null})),t}})();var we=t=>t,xe={"as is":{format:we},number:{format:(t,e)=>Intl.NumberFormat(e.baseName).format(Number(t))},date:{format:(t,e)=>{let r=d(t)?new Date(+t*1e3):h(t);return Intl.DateTimeFormat(e.baseName,Ne).format(r)}},datetime:{format:(t,e)=>{let r=d(t)?new Date(+t*1e3):h(t);return Intl.DateTimeFormat(e.baseName,Fe).format(r)}},timestamp:{format:(t,e)=>{let r=d(t)?new Date(+t):h(t);return Intl.DateTimeFormat(e.baseName,Oe).format(r)}},"long date":{format:(t,e)=>{let r=d(t)?new Date(+t*1e3):h(t);return Intl.DateTimeFormat(e.baseName,De).format(r)}},"long datetime":{format:(t,e)=>{let r=d(t)?new Date(+t*1e3):h(t);return Intl.DateTimeFormat(e.baseName,Ie).format(r)}}},x=[["year",1e3*60*60*24*365],["month",1e3*60*60*24*365/12],["day",1e3*60*60*24],["hour",1e3*60*60],["minute",1e3*60],["second",1e3]],St={"relative time":{format:(t,e)=>{let r=d(t)?new Date(+t*1e3):h(t);return Ft(e,r.valueOf())}}},Mt={"relative time duration":{format:(t,e)=>{let r=d(t)?new Date(+t*1e3):h(t);return Z(e,r.valueOf())}}},ke=Object.fromEntries(x.map(([t])=>[`in ${t}s`,{format:(e,r)=>{let n=d(e)?new Date(+e*1e3):h(e);return _e(r,t,n.valueOf())}}])),Ee=Object.fromEntries(x.map(([t])=>[`in ${t}s`,{format:(e,r)=>{let n=d(e)?new Date(+e*1e3):h(e);return ze(r,t,n.valueOf())}}])),Se=Object.fromEntries(x.map(([t,e])=>[`to ${t}s`,{format:(r,n)=>{let o=d(r)?new Date(+r*1e3):h(r);return Le(n,t,o.valueOf())}}])),Me=(()=>{let t={...St,...Mt};for(let[e]of Object.entries(St))for(let[r,n]of Object.entries(ke))t[`${e} ${r}`]=n;for(let[e]of Object.entries(Mt)){for(let[r,n]of Object.entries(Ee))t[`${e} ${r}`]=n;for(let[r,n]of Object.entries(Se))t[`${e} ${r}`]=n}return t})(),Fe={dateStyle:"short",timeStyle:"medium"},Ne={dateStyle:"short"},Oe={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",fractionalSecondDigits:3,hour12:!1},De={dateStyle:"long"},Ie={dateStyle:"long",timeStyle:"long"};function Ft(t,e,r=b()){let n=e-r,o=new Intl.RelativeTimeFormat(t.baseName,{numeric:"auto"});for(let[s,a]of x)if(Math.abs(n)>a)return o.format(Math.floor(n/a),s);return o.format(0,"seconds")}function Z(t,e,r=b()){let n=Math.abs(e-r);for(let[o,s]of x)if(n>s)return Intl.NumberFormat(t.baseName,{style:"unit",unit:o,unitDisplay:"long"}).format(Math.floor(n/s));return Intl.NumberFormat(t.baseName,{style:"unit",unit:"seconds",unitDisplay:"long"}).format(0)}function _e(t,e,r,n=b()){let o=r-n,s=new Intl.RelativeTimeFormat(t.baseName,{numeric:"auto"});for(let[a,c]of x)if(a===e)return s.format(Math.floor(o/c),e);return Ft(t,r,n)}function ze(t,e,r,n=b()){let o=Math.abs(r-n);for(let[s,a]of x)if(s===e){if(o<a)break;return Intl.NumberFormat(t.baseName,{style:"unit",unit:e,unitDisplay:"long"}).format(Math.floor(o/a))}return Z(t,r,n)}function Le(t,e,r,n=b()){let o=Math.abs(r-n),s=new Intl.ListFormat(t.baseName,{style:"long",type:"conjunction"}),a=u=>Intl.NumberFormat(t.baseName,{style:"unit",unit:u,unitDisplay:"long"}),c=[];for(let[u,m]of x){if(o>m){let l=Math.floor(o/m);c.push(a(u).format(l)),o-=l*m}if(u===e){if(c.length)break;return Z(t,r,n)}}return s.format(c)}var w={...xe,...Me};var q=w["as is"].format,Ae={number:{value:400,matchPredicate:()=>t=>d(t),defaultFormat:w.number.format,isConstant:!0},string:{value:300,matchPredicate:()=>t=>t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'")||t.startsWith("`")&&t.endsWith("`"),defaultFormat:q,isConstant:!0}},Pe={string:{value:1<<20,matchPredicate:t=>e=>t===e,defaultFormat:q,isConstant:!0},regex:{value:200,matchPredicate:t=>{let e=new RegExp(t);return r=>e.test(r)},defaultFormat:q,isConstant:!0},any:{value:100,matchPredicate:()=>()=>!0,defaultFormat:q,isConstant:!0}},Ce={"unix timestamp":{value:550,matchPredicate:()=>t=>d(t),defaultFormat:w.datetime.format,isConstant:!1},"iso 8601":{value:550,matchPredicate:()=>t=>!isNaN(h(t)),defaultFormat:w.datetime.format,isConstant:!1},date:{value:500,matchPredicate:()=>t=>d(t)||!isNaN(h(t)),defaultFormat:w.datetime.format,isConstant:!1},"unix millis":{value:550,matchPredicate:()=>t=>d(t),defaultFormat:w.timestamp.format,isConstant:!1}},je={past:{additionalvalue:50,defaultMatchPredicate:t=>()=>{let e=t();return r=>e(r)&&U.millisecond.currentTimeCompare(r)<=0}},present:{additionalvalue:100,defaultMatchPredicate:t=>()=>{let e=t();return r=>e(r)&&U.second.currentTimeCompare(r)===0}},future:{additionalvalue:50,defaultMatchPredicate:t=>()=>{let e=t();return r=>e(r)&&U.millisecond.currentTimeCompare(r)>0}}},U={millisecond:{additionalvalue:33,currentTimeCompare:t=>{let e=d(t)?new Date(+t*1e3).valueOf():h(t),r=b();return e-r}},second:{additionalvalue:30,currentTimeCompare:t=>{let e=d(t)?new Date(+t*1e3).valueOf():h(t),r=b();return Math.floor(e/1e3)-Math.floor(r/1e3)}},minute:{additionalvalue:29,currentTimeCompare:t=>{let e=d(t)?new Date(+t*1e3).valueOf():h(t),r=b();return Math.floor(e/6e4)-Math.floor(r/6e4)}},hour:{additionalvalue:28,currentTimeCompare:t=>{let e=d(t)?new Date(+t*1e3).valueOf():h(t),r=b();return Math.floor(e/36e4)-Math.floor(r/36e4)}},day:{additionalvalue:27,currentTimeCompare:t=>{let e=d(t)?new Date(+t*1e3).valueOf():h(t),r=b();return Math.floor(e/864e5)-Math.floor(r/864e5)}},week:{additionalvalue:26,currentTimeCompare:t=>{let e=new Date(d(t)?+t*1e3:h(t)),r=new Date(b()),n=r.getFullYear(),o=e.getFullYear()-n;if(o!==0)return o;let s=new Date(n,0,1),a=s.getDay(),c=s.valueOf(),u=Math.ceil(((r.valueOf()-c)/864e5+a+1)/7);return Math.ceil(((e.valueOf()-c)/864e5+a+1)/7)-u}},month:{additionalvalue:25,currentTimeCompare:t=>{let e=new Date(d(t)?+t*1e3:h(t)),r=new Date(b());return e.getFullYear()*12+e.getMonth()-r.getFullYear()*12+r.getMonth()}},year:{additionalvalue:24,currentTimeCompare:t=>{let e=new Date(d(t)?+t*1e3:h(t)),r=new Date(b());return e.getFullYear()-r.getFullYear()}}};function Re(){let{entries:t,fromEntries:e}=Object;return e(t(Ce).flatMap(([r,n])=>{let o=[[r,n]];for(let[s,a]of t(je)){let c={...n,value:n.value+a.additionalvalue,matchPredicate:a.defaultMatchPredicate(n.matchPredicate)};o.push([`${s} ${r}`,c]);for(let[u,m]of t(U))o.push([`${s} ${u} ${r}`,{...c,value:c.value+m.additionalvalue}])}return o}))}var y={special:Pe,named:{...Ae,...Re()}};function Nt(t){return $e(t.tokens)}function $e(t){let e=t.filter(s=>s.type===i.capture),r=e.length,o=e.map(We).reduce((s,a)=>s+a,0);return{priority:[r,o],priorityAsNumber:qe(r,o)}}function We(t){if(t.childTokens.length===0)return y.special.any.value;let e=Number.MAX_SAFE_INTEGER,r="";for(let n of t.childTokens)switch(n.type){case i.capture_expr:r=r?`${r} ${n.text}`:n.text;continue;case i.capture_expr_sep:e=Math.min(e,y.named[r]?.value??0),r="";continue;case i.regex:e=Math.min(e,y.special.regex.value);continue;case i.sq_string:case i.dq_string:case i.bt_string:e=Math.min(e,y.named.string.value);continue}return r&&(e=Math.min(e,y.named[r]?.value??0)),e}var qe=(t,e)=>Number.MAX_SAFE_INTEGER-(t<<20)+e;function Ot(t){return String(t).replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var Dt=()=>!1,H=Object.freeze([]),Ue=Object.freeze({isMatch:!0,expressionInfo:y.special.any}),Ke=Object.freeze({isMatch:!1}),He={matchPredicate:()=>Ue},K=Object.freeze({isMatch:!1,parameters:H,defaultFormatters:H}),Ve=Object.freeze({isMatch:!0,parameters:H,defaultFormatters:H}),Je=t=>e=>t===e?Ve:K;function Ye(t){let e=t.filter(s=>s.type===i.capture);if(e.length<=0){let s=t.map(a=>a.text).join("");return Je(s)}let r=e.map(s=>{let a=[];if(s.childTokens.length===0)return He;let c="";for(let u of s.childTokens)switch(u.type){case i.capture_expr:c=c?`${c} ${u.text}`:u.text;continue;case i.capture_expr_sep:a.push({type:"expression",text:c,expressionInfo:y.named[c],matches:y.named[c]?.matchPredicate()??Dt}),c="";continue;case i.regex:a.push({type:"regex",text:u.text,expressionInfo:y.special.regex,matches:y.special.regex.matchPredicate(u.text.slice(1,-1))});continue;case i.sq_string:case i.dq_string:case i.bt_string:a.push({type:"string",text:u.text,expressionInfo:y.special.string,matches:y.special.string.matchPredicate(u.text)});continue}return c&&a.push({type:"expression",text:c,expressionInfo:y.named[c],matches:y.named[c]?.matchPredicate()??Dt}),{matchPredicate:u=>{let m=a.find(l=>l.matches(u));return m?{isMatch:!0,expressionInfo:m.expressionInfo}:Ke}}}),n=t.map(s=>s.type===i.capture?"(.*)":Ot(s.text)).join(""),o=new RegExp("^"+n+"$");return s=>{if(typeof s!="string")return K;let a=s.match(o);if(a==null)return K;let c=a.slice(1),u=[];for(let[l,f]of c.entries()){let g=r[l].matchPredicate(f);if(!g.isMatch)return K;u.push(g.expressionInfo)}let m=u.map(l=>l.defaultFormat);return{isMatch:!0,parameters:c,defaultFormatters:m}}}function It(t){return Ye(t.tokens)}function _t(t){return t.text}function Ge(t){let{childTokens:e}=t;if(e.length<=0)return"{}";let r=tt(e[0]);for(let n=1,o=e.length;n<o;n++){let s=e[n-1],a=e[n];s.type===i.capture_expr&&a.type===i.capture_expr&&(r+=" "),r+=tt(a)}return`{${r}}`}var Be={[i.capture]:Ge,[i.normal]:_t};function tt(t){return(Be[t.type]??_t)(t)}function Qe(t){return t.tokens.map(tt).join("")}function zt(t){let e=W(t),{priority:r,priorityAsNumber:n}=Nt(e),o=It(e),s=Qe(e);return{priority:r,priorityAsNumber:n,key:t,ast:e,match:o,normalizedKey:s,matches:a=>o(a).isMatch}}var Xe=Object.freeze([]),Ze=t=>({...t,format:(e,r,n)=>{let{strings:o,formatters:s}=t,a=o[0];for(let c=1,u=o.length;c<u;++c)a+=s[c-1](e,r,n)+o[c];return a}}),tr=t=>({strings:[t],formatters:Xe,format:()=>t});function er(t){let e=[],r="";for(let n of t.childTokens)switch(n.type){case i.capture_expr:r=r?`${r} ${n.text}`:n.text;continue;case i.capture_expr_sep:e.push({type:"expression",text:r}),r="";continue;case i.sq_string:case i.dq_string:case i.bt_string:e.push({type:"string",text:n.text.slice(1,n.text.length-1)});continue;default:console.error("error: invalid expression, ignoring...")}return r&&e.push({type:"expression",text:r}),e}function rr(t){return t.defaultFormatters&&typeof t.position=="number"?{...t,result:t.defaultFormatters[t.position](t.result,t.locale)}:t}var nr=t=>e=>{let{parameters:r}=e;return r.length<=t?{...e,result:"",exit:!0}:{...e,position:t,result:r[t]}},or=(t,e,r,n=[])=>{let o={parameters:e,defaultFormatters:n,result:"",locale:r};for(let s of t){if(o.exit)return o.result;o=s(o)}return o.result};function sr(t){if(t.filter(o=>o.type===i.capture).length<=0){let o=t.map(s=>s.text).join("");return tr(o)}let r=[],n=[];for(let o of t){if(o.type!==i.capture){r.push(o.text);continue}let s=er(o);if(s.length===0){n.push(()=>"");continue}let a=[],[c,...u]=s;if(c.type==="string"){let{text:m}=c;a.push(l=>({...l,result:m}))}else if(Et(c.text)){let m=+c.text;a.push(nr(m))}else{n.push(()=>"");continue}for(let m of u){let{text:l}=m;if(Object.hasOwn(w,l)){let f=w[l];a.push(g=>({...g,result:f.format(g.result,g.locale)}))}}a.length<=1&&a.push(rr),n.push((m,l,f)=>or(a,m,l,f))}return r.length===n.length&&r.push(""),Ze({strings:r,formatters:n})}function Lt(t){return sr(t.tokens)}var ar=(()=>{let t=[],e=n=>n.text;t[i.normal]=e,t[i.capture]=n=>{let{childTokens:o}=n;if(o.length<=0)return"{}";let s=r(o[0]);for(let a=1,c=o.length;a<c;a++){let u=o[a-1],m=o[a];u.type===i.capture_expr&&m.type===i.capture_expr&&(s+=" "),s+=r(m)}return`{${s}}`};let r=n=>(t[n.type]??e)(n);return r})();function ir(t){return t.tokens.map(e=>ar(e)).join("")}function At(t){let e=W(t),r=Lt(e),n=ir(e);return{value:t,ast:e,formatter:r,format:r.format,normalizedValue:n}}function cr(t){let e={literalKeys:{},templateKeys:{},sortedTemplateKeys:[],prefixTemplateSearchByWords:{}},{literalKeys:r,templateKeys:n,sortedTemplateKeys:o,prefixTemplateSearchByWords:s}=e;for(let[a,c]of Object.entries(t)){let u=zt(a);if(u.priority[0]<=0){r[a]=c;continue}let m={key:a,parsedKey:u,value:c};n[a]=m,o.push(m);let l=u.ast.tokens[0].text;s[l]||={},s[l][a]=c}return o.sort((a,c)=>c.parsedKey.priorityAsNumber-a.parsedKey.priorityAsNumber),e}var Pt=new WeakMap;function _(t,e){let r=Pt.get(e);r||(r={cache:{},optimizedMap:cr(e)},Pt.set(e,r));let{cache:n,optimizedMap:o}=r;if(n[t]!=null)return n[t];if(o.literalKeys[t]!=null){let a=o.literalKeys[t];return n[t]={targetKey:t,translations:e,found:!0,valueTemplate:a,translate:Ct(a)},n[t]}let{templateKeys:s}=o;for(let{key:a}of o.sortedTemplateKeys){let{parsedKey:c}=s[a],u=c.match(t);if(u.isMatch){let m=s[a].value;return n[t]={targetKey:t,translations:e,found:!0,valueTemplate:m,translate:Ct(m,u)},n[t]}}return{targetKey:t,translations:e,found:!1,valueTemplate:"",translate:()=>t}}function Ct(t,e){let r=e?.parameters??[],n=e?.defaultFormatters??[],o;return s=>(o??=At(t),o.format(r,s,n))}var ur=new Set(["a","abbr","acronym","address","area","article","aside","b","bdi","bdo","big","blockquote","br","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","ins","kbd","label","legend","li","main","map","mark","marquee","meter","nav","nobr","ol","p","pre","q","rp","rt","ruby","s","samp","section","small","source","spacer","span","strike","strong","style","sub","summary","sup","time","tr","track","tt","u","ul","var","wbr"]),lr=new Set(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","slot","tabindex","title","translate","type","usemap","valign","value","width","xmlns"]),mr=t=>{let e=new DOMParser().parseFromString("<remove></remove>"+t,"text/html");return e.body.firstChild?.remove(),e.body},jt=({currentElement:t,removedElements:e,removedAttributes:r})=>{if(!ur.has(t.tagName.toLowerCase())){e.push(t),t.remove();return}let{attributes:n}=t;for(let o of Array.from(n)){let s=o.name.toLowerCase();(s==="data-i18n"||s.startsWith("data-i18n-")||!s.startsWith("data-")&&!s.startsWith("aria-")&&!lr.has(s))&&(r.push({name:s,from:t}),n.removeNamedItem(s))}for(let o of Array.from(t.children))jt({removedElements:e,removedAttributes:r,currentElement:o})};function Rt(t){let e=[],r=[],n=mr(t);for(let o of Array.from(n.children))jt({removedElements:e,removedAttributes:r,currentElement:o});return{html:n.innerHTML,removedElements:e,removedAttributes:r}}var fr=100,$t;function et(t){let{callbacks:e,tickingElements:r,timeoutNumber:n}=t;if(n===void 0&&r.size>0&&e.size>0){let o=1e3-b()%1e3;t.timeoutNumber=setTimeout(()=>{for(let s of e)s({targets:[...r],untick:a=>r.delete(a)});t.timeoutNumber=void 0,et(t)},o+fr)}}function pr(t){this.tickingElements.add(t),et(this)}function dr(t){this.tickingElements.add(t)}function gr(t){this.callbacks.add(t),et(this)}function hr(t){this.callbacks.delete(t)}function z(){this.tickingElements=new E,this.timeoutNumber=void 0,this.callbacks=new Set}z.prototype.tickElement=pr;z.prototype.untickElement=dr;z.prototype.addCallback=gr;z.prototype.removeCallback=hr;function rt(){return $t??=new z,$t}var nt=(t,e,r,n)=>{let{translations:o,import:s}=F(e).result,a=r.toString(),c=t[a]||{import:new Set,translations:{}},u=c.import;return s.forEach(m=>{let l=new URL(m,n).href;u.add(l)}),c.translations={...c.translations,...o},t[a]=c,t},br=(...t)=>{let e=t.reduce((r,n)=>{let{location:o,kind:s}=n,a=typeof o=="string"?o:o.href;if(s==="definition"){let u=F(n.data).result;return nt(r,u,n.language.toString(),o)}if(s==="translations"){let u=F(a).result;return nt(r,u,n.language.toString(),o)}let c=k(n.data).result;return Object.entries(c).reduce((u,[m,l])=>nt(u,l,m,o),r)},{});return Object.fromEntries(Object.entries(e).map(([r,{import:n,translations:o}])=>[r,{import:[...n],translations:o}]))},yr=t=>{let e=()=>{let r=br(...t);return e=()=>r,r};return()=>e()},V=t=>({addMap:(e,r)=>V([...t,{kind:"map",data:e,location:r}]),addDefinitionOnLanguage:(e,r,n)=>V([...t,{kind:"definition",language:r,data:e,location:n}]),addTranslations:(e,r)=>V([...t,{kind:"translations",language:r,location:e}]),build:yr(t)}),Wt=V([]);async function vr({document:t,location:e,merger:r}){let n=e.href,o=Array.from(t.querySelectorAll('link[rel="i18n-locale-map"]'));if(o.length<=0)return r;let s=o.flatMap(c=>{let u=c.getAttribute("href");return u?[wt(u,n).then(m=>({result:m,location:new URL(u,n)}))]:[]});return(await Promise.allSettled(s)).reduce((c,u)=>{if(u.status==="rejected")return console.error("error loading file: %o",u.reason),c;let{result:m,location:l}=u.value;return c.addMap(m,l)},r)}function Tr({document:t,location:e,merger:r}){let n=e.href,o=t.querySelectorAll('link[rel="i18n-translation-map"]');return o.length<=0?r:[...o].reduce((s,a)=>{let c=a.getAttribute("href"),u=a.getAttribute("lang");if(c==null)return console.error("link %o requires a href attribute, it will be ignored",a),s;if(u==null)return console.error("link %o requires a lang attribute, it will be ignored",a),s;try{let m=new Intl.Locale(u);return s.addTranslations(new URL(c,n),m)}catch{console.error(`invalid locale "${u}", it will be ignored`)}return s},r)}async function J({document:t,location:e}=window){e=typeof e=="string"?new URL(e):e;let r=await vr({document:t,location:e,merger:Wt}),n=Tr({document:t,location:e,merger:r}),o=C();return o.loadTranslations({location:e.href,languages:n.build()}),o}var ot,st=new WeakSet,S=class extends HTMLElement{constructor(){super(),Fr.observe(this),Mr.observe(this,Nr);let e=this.ownerDocument;if(j(e.documentElement))return;let r=e.defaultView;r&&(ot||(ot=J(r)),st.add(this),ot.then(n=>{R(e.documentElement,n),this.isConnected&&(this.updateNodes(),st.delete(this))}))}connectedCallback(){st.has(this)||this.updateNodes()}updateNodes(){return ct(this.querySelectorAll("*")).then(e=>{let r={elementsUpdated:e};if(e.length<=0)return r;let n=new CustomEvent("i18n-apply",{bubbles:!0,detail:r});return this.dispatchEvent(n),r})}};function ct(t){let e=[];for(let r of t){if(!vt(r)||!r.hasAttributes())continue;let n=wr(r),o=Object.entries(n),s=kr(r);if(o.length<=0&&s===it)continue;let a=new Intl.Locale(T(r));for(let[u,m]of o){let l=qt(m,a,r).then(f=>r.getAttribute(u)===f?null:(r.setAttribute(u,f),r));e.push(l)}if(s!==it){let u=qt(s.key,a,r).then(m=>{let l=r.innerHTML;return s.contentSetter(r,m),l===r.innerHTML?null:r});e.push(u)}r.hasAttribute("data-i18n-tick-time")&&rt().tickElement(r)}return Promise.allSettled(e).then(r=>r.flatMap(n=>n.status==="fulfilled"&&n.value?[n.value]:[]))}async function qt(t,e,r){for(let n of $(r)){let o=_(t,await n.store.translationsFromLanguage(e));if(o.found)return o.translate(e)}return t}var Ut={"data-i18n--":1,"data-i18n-attr-":2,"data-i18n-attribute-":3},Kt=/^(data-i18n-(?:attr(?:ibute)?)?-)(.*)$/;function wr(t){let e={};for(let r of t.attributes){let{name:n,value:o}=r,s=n.match(Kt);if(!s)continue;let[,a,c]=s,u=e[c];(!u||Ut[u.prefix]<Ut[a])&&(e[c]={prefix:a,value:o})}return Object.fromEntries(Object.entries(e).map(([r,n])=>[r,n.value]))}var Ht=(()=>{function t(n,o){n.textContent=o}function e(n,o){n.innerHTML=o}function r(n,o){n.innerHTML=Rt(o).html}return{"data-i18n-unsafe-html":{priority:1,contentSetter:e},"data-i18n-html":{priority:2,contentSetter:r},"data-i18n":{priority:2,contentSetter:t},"data-i18n-text":{priority:3,contentSetter:t}}})(),xr=Object.entries(Ht).map(([t,e])=>({...e,attribute:t})).sort((t,e)=>e.priority-t.priority),it=Object.freeze({attribute:"",key:"",priority:0,contentSetter:()=>{}});function kr(t){for(let e of xr){let{attribute:r}=e,n=t.getAttribute(r);if(n!=null)return{...e,key:n}}return it}var Vt={elements:new Set,subtrees:new Set};function Er(){let{elements:t,subtrees:e}=Vt;if(t.size===0&&e.size===0)return;let r=[...e].flatMap(o=>[...o.querySelectorAll("*")]),n=new Set([...t,...r]);t.clear(),e.clear(),ct(n)}var at;function Sr(t){let{elements:e,subtrees:r}=Vt;for(let n of t){let{target:o,type:s}=n;if(!(o instanceof Element)||s!=="attributes")continue;let{attributeName:a}=n;a&&n.oldValue!==o.getAttribute(a)&&(a==="lang"?(e.add(o),r.add(o)):(Object.hasOwn(Ht,a)||a.match(Kt))&&e.add(o))}at===void 0&&(e.size>0||r.size>0)&&(at=requestAnimationFrame(()=>{at=void 0,Er()}))}rt().addCallback(({untick:t,targets:e})=>{let r=e.filter(n=>{let o=n.hasAttribute("data-i18n-tick-time");return o||t(n),o});ct(r)});var Mr=new MutationObserver(Sr),Fr=new I(t=>{t.forEach(e=>{e.target instanceof S&&e.target.updateNodes()})}),Nr=Object.freeze({attributes:!0,subtree:!0});async function Or(t,e){if(!e)return await Dr(t);if("element"in e&&e.element){let{locale:o,element:s}=e,a=o||T(s);return await ut(t,s,a)}let{locale:r}=e,n=r||T(document.documentElement);return"store"in e&&e.store?await Ir(t,e.store,n):await ut(t,document.documentElement,n)}async function Dr(t){return await ut(t,document.documentElement,T(document.documentElement))}async function ut(t,e,r){let n=new Intl.Locale(r);if(e?.ownerDocument?.documentElement&&!j(e.ownerDocument.documentElement)){let o=document.defaultView;if(!o)return t;let s=await J(o);R(document.documentElement,s)}for(let o of $(e)){let s=_(t,await o.store.translationsFromLanguage(n));if(s.found)return s.translate(n)}return t}async function Ir(t,e,r){let n=new Intl.Locale(r),o=_(t,await e.translationsFromLanguage(n));return o.found?o.translate(n):t}var _r=new URL(import.meta.url),Y=_r.searchParams.get("named");Y&&(customElements.get(Y)!=null?console.error(`A custom element with name "${Y}" already exists`):customElements.define(Y,S));var zr=S,io=zr;export{I as ElementLangObserver,zr as I18nContainerElement,io as default,Or as translate};
//# sourceMappingURL=i18n.element.min.js.map
