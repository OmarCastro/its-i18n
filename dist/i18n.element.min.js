function Ht(t){return typeof t!="string"?{valid:!1,error:`expected string instead of ${I(t)}`}:t===""?{valid:!1,error:"cannot import empty path"}:{valid:!0}}function at(t){let e=[],r=[];for(let[n,o]of t.entries()){let a=Ht(o);if(!a.valid){r.push({path:`.[${n}]`,message:`${a.error}, ignoring import`});continue}e.push(o)}return{result:e,errors:r}}function Vt(t){return t===""?{result:[],errors:[{path:"",message:"cannot import empty path, ignoring import"}]}:typeof t=="string"?{result:[t],errors:[]}:Array.isArray(t)?at(t):{result:[],errors:[{path:"",message:`expected string or string array (string[]) instead of ${I(t)}`}]}}function $(t){if(!it(t))return{result:{},errors:[{path:"",message:`expected a plain object instead of ${I(t)}`}]};let e=[],r=[];for(let[n,o]of Object.entries(t)){if(typeof o!="string"){r.push({path:E(n),message:`expected string instead of ${I(o)}`});continue}e.push([n,o])}return{result:Object.fromEntries(e),errors:r}}function M(t){if(t==="")return{result:{import:[],translations:{}},errors:[{path:"",message:"cannot import empty path, ignoring import"}]};if(typeof t=="string")return{result:{import:[t],translations:{}},errors:[]};if(Array.isArray(t)){let s=at(t),i=s.errors;return{result:{import:s.result,translations:{}},errors:i}}if(!it(t))return{result:{import:[],translations:{}},errors:[{path:"",message:"invalid type"}]};let e=[],r=Object.hasOwn(t,"import"),n=Object.hasOwn(t,"translations"),o=(()=>{if(!r)return[];let s=Vt(t.import);return e.push(...s.errors.map(({path:i,message:u})=>({path:R(".import",i),message:u}))),s.result})(),a=(()=>{if(!n)return{};let s=$(t.translations);return e.push(...s.errors.map(({path:i,message:u})=>({path:R(".translations",i),message:u}))),s.result})();return r||n?{result:{import:o,translations:a},errors:e}:{result:{import:[],translations:{}},errors:[{path:"",message:'invalid object, the object must have "import" or "translations" keys'}]}}function w(t){let e=[],r=[],n=[];for(let[o,a]of Object.entries(t)){let s;try{s=new Intl.Locale(o)}catch{e.push({path:E(o),message:`invalid locale "${o}", it will be ignored`});continue}let{baseName:i}=s;if(i!==o)if(t[i]){e.push({path:E(o),message:`invalid locale "${o}", it also conflicts with correct locale "${i}", it will be ignored`});continue}else r.push({path:E(o),message:`invalid locale "${o}", fixed to locale "${i}"`});let u=M(a);if(u.errors.length){let m=E(o);e.push(...u.errors.map(({path:l,message:f})=>({path:R(m,l),message:f})))}n.push([i,u.result])}return{result:Object.fromEntries(n),warnings:r,errors:e}}var I=t=>t==null?String(t):typeof t,it=t=>t?.constructor===Object,E=t=>/^[a-z][a-z\d]*$/i.test(t)?`.${t}`:`.[${JSON.stringify(t)}]`,R=(t,e)=>t+(e==="."||e.startsWith(".[")?e.substring(1):e);var Jt=Object.freeze({importTranslations:()=>(console.error("importLanguage not implemented"),Promise.resolve({})),importI18nJson:()=>(console.error("importLanguage not implemented"),Promise.resolve({}))}),N=Object.seal({...Jt});function ct(t){typeof t?.importTranslations=="function"&&(N.importTranslations=t.importTranslations),typeof t?.importI18nJson=="function"&&(N.importI18nJson=t.importI18nJson)}async function Gt(t,e){let r=new URL(t,e),o=await(await fetch(r)).json(),a=$(o);return a.errors.forEach(s=>console.error("Error on %s::%s, %s",r.href,s.path,s.message)),a.result}async function Qt(t,e){let r=new URL(t,e),o=await(await fetch(r)).json(),a=w(o);return a.errors.forEach(s=>console.error("Error on %s::%s, %s",r.href,s.path,s.message)),a.warnings.forEach(s=>console.warn("Warning on %s::%s, %s",r.href,s.path,s.message)),a.result}ct({importTranslations:Gt,importI18nJson:Qt});function*ut(t){let e=t;for(;e!=null;){yield e;let{parentNode:r,parentElement:n}=e;if(r instanceof ShadowRoot){e=r.host;continue}if(r instanceof Document||n==null)return;e=n}}function*O(t){let e=t;for(;e!=null;){yield e;let{parentNode:r,parentElement:n,assignedSlot:o}=e;if(o){e=o;continue}if(r instanceof ShadowRoot){e=r.host;continue}if(r instanceof Document||n==null)return;e=n}}function Bt(t,e){return t===t.ownerDocument.documentElement?navigator.language:t.parentNode instanceof ShadowRoot?k(t.parentNode.host):k(t.parentElement)}function k(t){if(t==null)return navigator.language;for(let e of O(t)){let r=e.getAttribute("lang");if(r)try{let n=new Intl.Locale(r),{language:o,region:a}=n;return a==null?o:`${o}-${a}`}catch{return Bt(e,r)}}return navigator.language}var z=class{constructor(e=[]){for(let[r,n]of e)this.set(r,n)}get size(){return y(this).keySet.size}delete(e){let{keySet:r,refWeakMap:n}=y(this),o=n.get(e);return o?(r.delete(o.ref),n.delete(e),!0):!1}[Symbol.iterator](){return this.entries()}*entries(){let{refWeakMap:e}=y(this);for(let r of this.keys()){let n=e.get(r);n&&(yield[r,n.value])}}forEach(e,r){for(let[n,o]of this.entries())e.call(r,o,n,this)}get(e){return y(this).refWeakMap.get(e)?.value}has(e){return y(this).refWeakMap.has(e)}*keys(){let{keySet:e}=y(this),r=Array.from(e);for(let n of r){let o=n.deref();if(!o){e.delete(n);continue}yield o}}set(e,r){let{keySet:n,refWeakMap:o}=y(this),a=o.get(e);if(a!==void 0)return a.value=r,this;let s=new WeakRef(e);return o.set(e,{ref:s,value:r}),n.add(s),this}*values(){for(let[,e]of this.entries())yield e}},S=class{constructor(e=[]){for(let r of e)this.add(r)}get size(){return y(this).keySet.size}delete(e){let{keySet:r,refWeakMap:n}=y(this),o=n.get(e);return o?(r.delete(o.ref),n.delete(e),!0):!1}[Symbol.iterator](){return this.entries()}*entries(){for(let e of this.keys())yield e}forEach(e,r){for(let n of this.entries())e.call(r,n,this)}has(e){return y(this).refWeakMap.has(e)}*keys(){let{keySet:e}=y(this),r=Array.from(e);for(let n of r){let o=n.deref();if(!o){e.delete(n);continue}yield o}}add(e){let{keySet:r,refWeakMap:n}=y(this);if(n.has(e))return this;let o=new WeakRef(e);return n.set(e,{ref:o,value:!0}),r.add(o),this}*values(){for(let e of this.keys())yield e}},y=(()=>{let t=new WeakMap;function e(n){let s={keySet:new Set,refWeakMap:new WeakMap};return t.set(n,s),s}function r(n){return t.get(n)??e(n)}return r})();var W=new z,q=new WeakMap,U="lang-changed",Xt="lang-change-dispatched",Yt=Object.freeze({attributes:!0,attributeFilter:["lang"],subtree:!0});function Zt(t){let e=new Set,r=new Set;for(let o of t){let a=o.target.getRootNode();r.add(a);let s=W.get(a)?.observingElements;s&&s.forEach(i=>{if(e.has(i))return;let u=q.get(i),m=k(i);if(m===u)return;q.set(i,m);let l=new CustomEvent(U,{detail:{oldLang:u,lang:m}});i.dispatchEvent(l),e.add(i)})}let n=new CustomEvent(Xt,{detail:{triggeredNodes:Array.from(e)}});for(let o of r)o.dispatchEvent(n)}function te(t){let e=new MutationObserver(Zt);return e.observe(t,Yt),e}function lt(t,e){let r=W.get(t);if(r?r.observingElements.add(e):W.set(t,{observer:te(t),observingElements:new S([e]),targetNode:new WeakRef(t)}),t instanceof ShadowRoot){let n=t.host;lt(n.getRootNode(),e)}}function mt(t){let e=t.getRootNode();q.set(t,k(t)),lt(e,t)}function pt(t){if(t instanceof HTMLElement)return t.translate;if(t==null)return!1;for(let e of O(t)){if(e instanceof HTMLElement)return e.translate;let r=e.getAttribute("translate");if(r!=null){if(r===""||r==="yes")return!0;if(r==="no")return!1}}return!0}var ft=(t,e)=>N.importTranslations(t,e),dt=(t,e)=>N.importI18nJson(t,e);var ee=Object.freeze({}),re=Object.freeze({languages:ee,location:""});function ne(t){let e=w(t.languages);return e.errors.forEach(r=>console.error("Error on %s::%s, %s",t.location,r.path,r.message)),e.warnings.forEach(r=>console.warn("Warning on %s::%s, %s",t.location,r.path,r.message)),{location:t.location,languages:structuredClone(e.result)}}var K=new WeakMap;function ht(t){let e=K.get(t);if(e)return e;let r={};return K.set(t,r),r}var oe=async(t,e)=>{let r=ht(t);if(r[e])return r[e];let n=t.data.languages[e];if(!n)return{};if(!Array.isArray(n.import)||n.import.length<=0)return n.translations;let o=n.import.map(i=>ft(i,t.data.location)),s=(await Promise.all(o)).reduce((i,u)=>({...i,...u}));return r[e]={...s,...n.translations},r[e]},se={loadTranslations(t){this.data=ne(t),K.delete(this)},async translationsFromLanguage(t){if(typeof t=="string")return await this.translationsFromLanguage(new Intl.Locale(t));let e=ht(this);if(e[t.baseName])return e[t.baseName];let r=[t.baseName],n=t.language;if(t.region!=null){let i=`${n}-${t.region}`;r.includes(i)||r.push(i)}r.includes(n)||r.push(n);let o=r.reverse().map(i=>oe(this,i)),s=(await Promise.all(o)).reduce((i,u)=>({...i,...u}));return e[t.baseName]=s,s},data:re};function _(){return Object.create(se)}var ae=_(),ie=Object.freeze({store:ae}),gt=new WeakMap;var bt=(t,e)=>{gt.set(t,e)},H=function*(t){for(let e of ut(t)){let r=gt.get(e);r&&(yield{store:r,element:e})}yield ie};var c={normal:0,capture:1,capture_expr:2,capture_expr_sep:3,regex:4,sq_string:5,dq_string:6,bt_string:7,escape:8,previous:9,previous_ignore:10},p=t=>t.charCodeAt(0),ce=(()=>{let t=[];return t[c.normal]=c.normal,t[c.capture]=c.capture_expr,t[c.capture_expr]=c.capture_expr,t[c.capture_expr_sep]=c.previous_ignore,t[c.regex]=c.regex,t[c.sq_string]=c.sq_string,t[c.dq_string]=c.dq_string,t[c.bt_string]=c.bt_string,t[c.escape]=c.previous,t})(),ue=(()=>{let t=[];return t[p("{")]=c.capture,t})(),le=(()=>{let t=[];return t[p("}")]=c.previous,t[p("/")]=c.regex,t[p("'")]=c.sq_string,t[p('"')]=c.dq_string,t[p("`")]=c.bt_string,t[p("\\")]=c.escape,t[p("	")]=c.capture,t[p(" ")]=c.capture,t[p(`
`)]=c.capture,t[p("|")]=c.capture_expr_sep,t})(),me=(()=>{let t=[];return t[p("\\")]=c.previous_ignore,t[p("	")]=c.previous_ignore,t[p(" ")]=c.previous_ignore,t[p("|")]=c.previous_ignore,t[p(`
`)]=c.previous_ignore,t[p("}")]=c.previous_ignore,t})(),pe=(()=>{let t=[];return t[p("/")]=c.previous,t[p("\\")]=c.escape,t})(),fe=(()=>{let t=[];return t[p("'")]=c.previous,t[p("\\")]=c.escape,t})(),de=(()=>{let t=[];return t[p('"')]=c.previous,t[p("\\")]=c.escape,t})(),he=(()=>{let t=[];return t[p("`")]=c.previous,t[p("\\")]=c.escape,t})(),yt=(()=>{let t=[];return t[c.normal]=ue,t[c.capture]=le,t[c.capture_expr]=me,t[c.capture_expr_sep]=[],t[c.regex]=pe,t[c.sq_string]=fe,t[c.dq_string]=de,t[c.bt_string]=he,t[c.escape]=[],t})();function D(t){let e=c.normal,r=yt[e],n={tokens:[]},o={parentNode:n,start:0,end:0,type:c.normal,childTokens:[]},a=l=>{e=l,r=yt[e]},s=l=>l===n,i=l=>{if(a(o.parentNode.type??c.normal),o.type===c.escape){let{parentNode:d}=o;if(s(d)){o=n.tokens.pop();return}o=d;return}o.end=l+1;let{parentNode:f}=o;if(s(f)){f.tokens.push(o),o={parentNode:f,start:l+1,end:l+1,type:c.normal,childTokens:[]};return}f.childTokens.push(o),o=f},u=t.length;for(let l=0;l<u;l++){let f=t.charCodeAt(l),d=r[f]??ce[e];if(!(d==null||d===e)){if(d===c.previous){i(l);continue}if(d===c.previous_ignore){i(l-1),l--;continue}if(e===c.normal){if(t.charCodeAt(l+1)===f){l++;continue}o.end=l,o.end>o.start&&n.tokens.push(o),o={parentNode:n,start:l,end:l,type:d,childTokens:[]}}else o={parentNode:o,start:l,end:l,type:d,childTokens:[]};a(d)}}o.end=t.length,o.end>o.start&&n.tokens.push(o);let m=({start:l,end:f,type:d,childTokens:ot})=>{let st=t.substring(l,f),Kt=d===c.normal?st.replaceAll("{{","{"):st;return{start:l,end:f,type:d,text:Kt,childTokens:ot.map(m)}};return{key:t,tokens:n.tokens.map(m)}}function h(t){return typeof t=="string"&&t.trim()===t&&!isNaN(Number(t))&&!isNaN(parseFloat(t))}function vt(t){return typeof t=="string"&&/^[+-]?[0-9]+$/.test(t)}function b(t){if(typeof t!="string")return NaN;let e=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d)/;return t.match(e)?Date.parse(t):NaN}var x=(()=>{let t=null;return function(){return t===null&&(t=Date.now(),requestAnimationFrame(()=>{t=null})),t}})();var ge=t=>t,be={"as is":{format:ge},number:{format:(t,e)=>Intl.NumberFormat(e.baseName).format(Number(t))},date:{format:(t,e)=>{let r=h(t)?new Date(+t*1e3):b(t);return Intl.DateTimeFormat(e.baseName,we).format(r)}},datetime:{format:(t,e)=>{let r=h(t)?new Date(+t*1e3):b(t);return Intl.DateTimeFormat(e.baseName,ke).format(r)}},timestamp:{format:(t,e)=>{let r=h(t)?new Date(+t):b(t);return Intl.DateTimeFormat(e.baseName,Se).format(r)}},"long date":{format:(t,e)=>{let r=h(t)?new Date(+t*1e3):b(t);return Intl.DateTimeFormat(e.baseName,Ee).format(r)}},"long datetime":{format:(t,e)=>{let r=h(t)?new Date(+t*1e3):b(t);return Intl.DateTimeFormat(e.baseName,Me).format(r)}}},T=[["year",1e3*60*60*24*365],["month",1e3*60*60*24*365/12],["day",1e3*60*60*24],["hour",1e3*60*60],["minute",1e3*60],["second",1e3]],xt={"relative time":{format:(t,e)=>{let r=h(t)?new Date(+t*1e3):b(t);return V(e,r.valueOf())}}},Tt={"relative time duration":{format:(t,e)=>{let r=h(t)?new Date(+t*1e3):b(t);return kt(e,r.valueOf())}}},ye=Object.fromEntries(T.map(([t])=>[`in ${t}s`,{format:(e,r)=>{let n=h(e)?new Date(+e*1e3):b(e);return Ne(r,t,n.valueOf())}}])),ve=Object.fromEntries(T.map(([t])=>[`in ${t}s`,{format:(e,r)=>{let n=h(e)?new Date(+e*1e3):b(e);return Fe(r,t,n.valueOf())}}])),xe=Object.fromEntries(T.map(([t,e])=>[`to ${t}s`,{format:(r,n)=>{let o=h(r)?new Date(+r*1e3):b(r);return Ie(n,t,o.valueOf())}}])),Te=(()=>{let t={...xt,...Tt};for(let[e]of Object.entries(xt))for(let[r,n]of Object.entries(ye))t[`${e} ${r}`]=n;for(let[e]of Object.entries(Tt)){for(let[r,n]of Object.entries(ve))t[`${e} ${r}`]=n;for(let[r,n]of Object.entries(xe))t[`${e} ${r}`]=n}return t})(),ke={dateStyle:"short",timeStyle:"medium"},we={dateStyle:"short"},Se={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",fractionalSecondDigits:3,hour12:!1},Ee={dateStyle:"long"},Me={dateStyle:"long",timeStyle:"long"};function V(t,e,r=x()){let n=e-r,o=new Intl.RelativeTimeFormat(t.baseName,{numeric:"auto"});for(let[a,s]of T)if(Math.abs(n)>s)return o.format(Math.floor(n/s),a);return o.format(0,"seconds")}function kt(t,e,r=x()){let n=e-r;for(let[o,a]of T)if(Math.abs(n)>a)return Intl.NumberFormat(t.baseName,{style:"unit",unit:o,unitDisplay:"long"}).format(Math.floor(Math.abs(n)/a));return Intl.NumberFormat(t.baseName,{style:"unit",unit:"seconds",unitDisplay:"long"}).format(0)}function Ne(t,e,r,n=x()){let o=r-n,a=new Intl.RelativeTimeFormat(t.baseName,{numeric:"auto"});for(let[s,i]of T)if(s===e)return a.format(Math.floor(o/i),e);return V(t,r,n)}function Fe(t,e,r,n=x()){let o=r-n;for(let[a,s]of T)if(a===e)return Intl.NumberFormat(t.baseName,{style:"unit",unit:e,unitDisplay:"long"}).format(Math.floor(Math.abs(o)/s));return kt(t,r,n)}function Ie(t,e,r,n=x()){let o=r-n,a=new Intl.ListFormat(t.baseName,{style:"long",type:"conjunction"}),s=(u,m="long")=>Intl.NumberFormat(t.baseName,{style:"unit",unit:u,unitDisplay:m}),i=[];for(let[u,m]of T){if(Math.abs(o)>m){let l=Math.floor(Math.abs(o)/m);i.push(s(u).format(l)),o-=l*m*Math.sign(o)}if(u===e){if(i.length)break;return V(t,r,n)}}return a.format(i)}var v={...be,...Te};var A=v["as is"].format,Oe={number:{value:400,matchPredicate:()=>t=>h(t),defaultFormat:v.number.format,isConstant:!0},string:{value:300,matchPredicate:()=>t=>t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'")||t.startsWith("`")&&t.endsWith("`"),defaultFormat:A,isConstant:!0}},ze={string:{value:1<<20,matchPredicate:t=>e=>t===e,defaultFormat:A,isConstant:!0},regex:{value:200,matchPredicate:t=>{let e=new RegExp(t);return r=>e.test(r)},defaultFormat:A,isConstant:!0},any:{value:100,matchPredicate:()=>()=>!0,defaultFormat:A,isConstant:!0}},_e={"unix timestamp":{value:550,matchPredicate:()=>t=>h(t),defaultFormat:v.datetime.format,isConstant:!1},"iso 8601":{value:550,matchPredicate:()=>t=>!isNaN(b(t)),defaultFormat:v.datetime.format,isConstant:!1},date:{value:500,matchPredicate:()=>t=>h(t)||!isNaN(b(t)),defaultFormat:v.datetime.format,isConstant:!1},"unix millis":{value:550,matchPredicate:()=>t=>h(t),defaultFormat:v.timestamp.format,isConstant:!1}},De={past:{additionalvalue:50},present:{additionalvalue:100},future:{additionalvalue:50}},Ae={millisecond:{additionalvalue:33},second:{additionalvalue:30},minute:{additionalvalue:29},hour:{additionalvalue:28},day:{additionalvalue:27},week:{additionalvalue:26},month:{additionalvalue:25},year:{additionalvalue:24}};function je(){let{entries:t,fromEntries:e}=Object;return e(t(_e).flatMap(([r,n])=>{let o=[[r,n]];for(let[a,s]of t(De)){let i={...n,value:n.value+s.additionalvalue};o.push([`${a} ${r}`,i]);for(let[u,m]of t(Ae))o.push([`${a} ${u} ${r}`,{...i,value:i.value+m.additionalvalue}])}return o}))}var g={special:ze,named:{...Oe,...je()}};function wt(t){return Pe(t.tokens)}function Pe(t){let e=t.filter(a=>a.type===c.capture),r=e.length,o=e.map(Ce).reduce((a,s)=>a+s,0);return{priority:[r,o],priorityAsNumber:Le(r,o)}}function Ce(t){if(t.childTokens.length===0)return g.special.any.value;let e=Number.MAX_SAFE_INTEGER,r="";for(let n of t.childTokens)switch(n.type){case c.capture_expr:r=r?`${r} ${n.text}`:n.text;continue;case c.capture_expr_sep:e=Math.min(e,g.named[r]?.value??0),r="";continue;case c.regex:e=Math.min(e,g.special.regex.value);continue;case c.sq_string:case c.dq_string:case c.bt_string:e=Math.min(e,g.named.string.value);continue}return r&&(e=Math.min(e,g.named[r]?.value??0)),e}var Le=(t,e)=>Number.MAX_SAFE_INTEGER-(t<<20)+e;function St(t){return String(t).replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var Et=()=>!1,P=Object.freeze([]),Re=Object.freeze({isMatch:!0,expressionInfo:g.special.any}),$e=Object.freeze({isMatch:!1}),We={matchPredicate:()=>Re},j=Object.freeze({isMatch:!1,parameters:P,defaultFormatters:P}),qe=Object.freeze({isMatch:!0,parameters:P,defaultFormatters:P}),Ue=t=>e=>t===e?qe:j;function Ke(t){let e=t.filter(a=>a.type===c.capture);if(e.length<=0){let a=t.map(s=>s.text).join("");return Ue(a)}let r=e.map(a=>{let s=[];if(a.childTokens.length===0)return We;let i="";for(let u of a.childTokens)switch(u.type){case c.capture_expr:i=i?`${i} ${u.text}`:u.text;continue;case c.capture_expr_sep:s.push({type:"expression",text:i,expressionInfo:g.named[i],matches:g.named[i]?.matchPredicate()??Et}),i="";continue;case c.regex:s.push({type:"regex",text:u.text,expressionInfo:g.special.regex,matches:g.special.regex.matchPredicate(u.text.slice(1,-1))});continue;case c.sq_string:case c.dq_string:case c.bt_string:s.push({type:"string",text:u.text,expressionInfo:g.special.string,matches:g.special.string.matchPredicate(u.text)});continue}return i&&s.push({type:"expression",text:i,expressionInfo:g.named[i],matches:g.named[i]?.matchPredicate()??Et}),{matchPredicate:u=>{let m=s.find(l=>l.matches(u));return m?{isMatch:!0,expressionInfo:m.expressionInfo}:$e}}}),n=t.map(a=>a.type===c.capture?"(.*)":St(a.text)).join(""),o=new RegExp("^"+n+"$");return a=>{if(typeof a!="string")return j;let s=a.match(o);if(s==null)return j;let i=s.slice(1),u=[];for(let[l,f]of i.entries()){let d=r[l].matchPredicate(f);if(!d.isMatch)return j;u.push(d.expressionInfo)}let m=u.map(l=>l.defaultFormat);return{isMatch:!0,parameters:i,defaultFormatters:m}}}function Mt(t){return Ke(t.tokens)}function Nt(t){return t.text}function He(t){let{childTokens:e}=t;if(e.length<=0)return"{}";let r=J(e[0]);for(let n=1,o=e.length;n<o;n++){let a=e[n-1],s=e[n];a.type===c.capture_expr&&s.type===c.capture_expr&&(r+=" "),r+=J(s)}return`{${r}}`}var Ve={[c.capture]:He,[c.normal]:Nt};function J(t){return(Ve[t.type]??Nt)(t)}function Je(t){return t.tokens.map(J).join("")}function Ft(t){let e=D(t),{priority:r,priorityAsNumber:n}=wt(e),o=Mt(e),a=Je(e);return{priority:r,priorityAsNumber:n,key:t,ast:e,match:o,normalizedKey:a,matches:s=>o(s).isMatch}}var Ge=Object.freeze([]),Qe=t=>({...t,format:(e,r,n)=>{let{strings:o,formatters:a}=t,s=o[0];for(let i=1,u=o.length;i<u;++i)s+=a[i-1](e,r,n)+o[i];return s}}),Be=t=>({strings:[t],formatters:Ge,format:()=>t});function Xe(t){let e=[],r="";for(let n of t.childTokens)switch(n.type){case c.capture_expr:r=r?`${r} ${n.text}`:n.text;continue;case c.capture_expr_sep:e.push({type:"expression",text:r}),r="";continue;case c.sq_string:case c.dq_string:case c.bt_string:e.push({type:"string",text:n.text.slice(1,n.text.length-1)});continue;default:console.error("error: invalid expression, ignoring...")}return r&&e.push({type:"expression",text:r}),e}function Ye(t){return t.defaultFormatters&&typeof t.position=="number"?{...t,result:t.defaultFormatters[t.position](t.result,t.locale)}:t}var Ze=t=>e=>{let{parameters:r}=e;return r.length<=t?{...e,result:"",exit:!0}:{...e,position:t,result:r[t]}},tr=(t,e,r,n=[])=>{let o={parameters:e,defaultFormatters:n,result:"",locale:r};for(let a of t){if(o.exit)return o.result;o=a(o)}return o.result};function er(t){if(t.filter(o=>o.type===c.capture).length<=0){let o=t.map(a=>a.text).join("");return Be(o)}let r=[],n=[];for(let o of t){if(o.type!==c.capture){r.push(o.text);continue}let a=Xe(o);if(a.length===0){n.push(()=>"");continue}let s=[],[i,...u]=a;if(i.type==="string"){let{text:m}=i;s.push(l=>({...l,result:m}))}else if(vt(i.text)){let m=+i.text;s.push(Ze(m))}else{n.push(()=>"");continue}for(let m of u){let{text:l}=m;if(Object.hasOwn(v,l)){let f=v[l];s.push(d=>({...d,result:f.format(d.result,d.locale)}))}}s.length<=1&&s.push(Ye),n.push((m,l,f)=>tr(s,m,l,f))}return r.length===n.length&&r.push(""),Qe({strings:r,formatters:n})}function It(t){return er(t.tokens)}var rr=(()=>{let t=[],e=n=>n.text;t[c.normal]=e,t[c.capture]=n=>{let{childTokens:o}=n;if(o.length<=0)return"{}";let a=r(o[0]);for(let s=1,i=o.length;s<i;s++){let u=o[s-1],m=o[s];u.type===c.capture_expr&&m.type===c.capture_expr&&(a+=" "),a+=r(m)}return`{${a}}`};let r=n=>(t[n.type]??e)(n);return r})();function nr(t){return t.tokens.map(e=>rr(e)).join("")}function Ot(t){let e=D(t),r=It(e),n=nr(e);return{value:t,ast:e,formatter:r,format:r.format,normalizedValue:n}}function or(t){let e={literalKeys:{},templateKeys:{},sortedTemplateKeys:[],prefixTemplateSearchByWords:{}},{literalKeys:r,templateKeys:n,sortedTemplateKeys:o,prefixTemplateSearchByWords:a}=e;for(let[s,i]of Object.entries(t)){let u=Ft(s);if(u.priority[0]<=0){r[s]=i;continue}let m={key:s,parsedKey:u,value:i};n[s]=m,o.push(m);let l=u.ast.tokens[0].text;a[l]||={},a[l][s]=i}return o.sort((s,i)=>i.parsedKey.priorityAsNumber-s.parsedKey.priorityAsNumber),e}var zt=new WeakMap;function Dt(t,e){let r=zt.get(e);r||(r={cache:{},optimizedMap:or(e)},zt.set(e,r));let{cache:n,optimizedMap:o}=r;if(n[t]!=null)return n[t];if(o.literalKeys[t]!=null){let s=o.literalKeys[t];return n[t]={targetKey:t,translations:e,found:!0,valueTemplate:s,translate:_t(s)},n[t]}let{templateKeys:a}=o;for(let{key:s}of o.sortedTemplateKeys){let{parsedKey:i}=a[s],u=i.match(t);if(u.isMatch){let m=a[s].value;return n[t]={targetKey:t,translations:e,found:!0,valueTemplate:m,translate:_t(m,u)},n[t]}}return{targetKey:t,translations:e,found:!1,valueTemplate:"",translate:()=>t}}function _t(t,e){let r=e?.parameters??[],n=e?.defaultFormatters??[],o;return a=>(o??=Ot(t),o.format(r,a,n))}var sr=new Set(["a","abbr","acronym","address","area","article","aside","b","bdi","bdo","big","blockquote","br","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","ins","kbd","label","legend","li","main","map","mark","marquee","meter","nav","nobr","ol","p","pre","q","rp","rt","ruby","s","samp","section","small","source","spacer","span","strike","strong","style","sub","summary","sup","time","tr","track","tt","u","ul","var","wbr"]),ar=new Set(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","slot","tabindex","title","translate","type","usemap","valign","value","width","xmlns"]),ir=t=>{let e=new DOMParser().parseFromString("<remove></remove>"+t,"text/html");return e.body.firstChild?.remove(),e.body},At=({currentElement:t,removedElements:e,removedAttributes:r})=>{if(!sr.has(t.tagName.toLowerCase())){e.push(t),t.remove();return}let{attributes:n}=t;for(let o of Array.from(n)){let a=o.name.toLowerCase();(a==="data-i18n"||a.startsWith("data-i18n-")||!a.startsWith("data-")&&!a.startsWith("aria-")&&!ar.has(a))&&(r.push({name:a,from:t}),n.removeNamedItem(a))}for(let o of Array.from(t.children))At({removedElements:e,removedAttributes:r,currentElement:o})};function jt(t){let e=[],r=[],n=ir(t);for(let o of Array.from(n.children))At({removedElements:e,removedAttributes:r,currentElement:o});return{html:n.innerHTML,removedElements:e,removedAttributes:r}}var cr=100,Pt;function G(t){let{callbacks:e,tickingElements:r,timeoutNumber:n}=t;if(n===void 0&&r.size>0&&e.size>0){let o=1e3-x()%1e3;t.timeoutNumber=setTimeout(()=>{for(let a of e)a({targets:[...r],untick:s=>r.delete(s)});t.timeoutNumber=void 0,G(t)},o+cr)}}function ur(t){this.tickingElements.add(t),G(this)}function lr(t){this.tickingElements.add(t)}function mr(t){this.callbacks.add(t),G(this)}function pr(t){this.callbacks.delete(t)}function F(){this.tickingElements=new S,this.timeoutNumber=void 0,this.callbacks=new Set}F.prototype.tickElement=ur;F.prototype.untickElement=lr;F.prototype.addCallback=mr;F.prototype.removeCallback=pr;function Q(){return Pt??=new F,Pt}var B=(t,e,r,n)=>{let{translations:o,import:a}=M(e).result,s=r.toString(),i=t[s]||{import:new Set,translations:{}},u=i.import;return a.forEach(m=>{let l=new URL(m,n).href;u.add(l)}),i.translations={...i.translations,...o},t[s]=i,t},fr=(...t)=>{let e=t.reduce((r,n)=>{let{location:o,kind:a}=n,s=typeof o=="string"?o:o.href;if(a==="definition"){let u=M(n.data).result;return B(r,u,n.language.toString(),o)}if(a==="translations"){let u=M(s).result;return B(r,u,n.language.toString(),o)}let i=w(n.data).result;return Object.entries(i).reduce((u,[m,l])=>B(u,l,m,o),r)},{});return Object.fromEntries(Object.entries(e).map(([r,{import:n,translations:o}])=>[r,{import:[...n],translations:o}]))},dr=t=>{let e=()=>{let r=fr(...t);return e=()=>r,r};return()=>e()},C=t=>({addMap:(e,r)=>C([...t,{kind:"map",data:e,location:r}]),addDefinitionOnLanguage:(e,r,n)=>C([...t,{kind:"definition",language:r,data:e,location:n}]),addTranslations:(e,r)=>C([...t,{kind:"translations",language:r,location:e}]),build:dr(t)}),Ct=C([]);async function hr({document:t,location:e,merger:r}){let n=e.href,o=Array.from(t.querySelectorAll('link[rel="i18n-locale-map"]'));if(o.length<=0)return r;let a=o.flatMap(i=>{let u=i.getAttribute("href");return u?[dt(u,n).then(m=>({result:m,location:new URL(u,n)}))]:[]});return(await Promise.allSettled(a)).reduce((i,u)=>{if(u.status==="rejected")return console.error("error loading file: %o",u.reason),i;let{result:m,location:l}=u.value;return i.addMap(m,l)},r)}function gr({document:t,location:e,merger:r}){let n=e.href,o=t.querySelectorAll('link[rel="i18n-translation-map"]');return o.length<=0?r:[...o].reduce((a,s)=>{let i=s.getAttribute("href"),u=s.getAttribute("lang");if(i==null)return console.error("link %o requires a href attribute, it will be ignored",s),a;if(u==null)return console.error("link %o requires a lang attribute, it will be ignored",s),a;try{let m=new Intl.Locale(u);return a.addTranslations(new URL(i,n),m)}catch{console.error(`invalid locale "${u}", it will be ignored`)}return a},r)}async function Lt({document:t,location:e}=window){e=typeof e=="string"?new URL(e):e;let r=await hr({document:t,location:e,merger:Ct}),n=gr({document:t,location:e,merger:r}),o=_();return o.loadTranslations({location:e.href,languages:n.build()}),o}var X,Y=new WeakSet,tt=class extends HTMLElement{constructor(){super(),mt(this),this.addEventListener(U,()=>this.updateNodes()),kr.observe(this,wr);let e=this.ownerDocument;if(Array.from(H(e.documentElement)).length>=2)return;let n=e.defaultView;n&&(X||(X=Lt(n)),Y.add(this),X.then(o=>{bt(e.documentElement,o),this.isConnected&&(this.updateNodes(),Y.delete(this))}))}connectedCallback(){Y.has(this)||this.updateNodes()}updateNodes(){return rt(this.querySelectorAll("*")).then(e=>{let r={elementsUpdated:e};if(e.length<=0)return r;let n=new CustomEvent("i18n-apply",{bubbles:!0,detail:r});return this.dispatchEvent(n),r})}};function rt(t){let e=[];for(let r of t){if(!pt(r)||!r.hasAttributes())continue;let n=br(r),o=Object.entries(n),a=vr(r);if(o.length<=0&&a===et)continue;let s=new Intl.Locale(k(r));for(let[u,m]of o){let l=Rt(m,s,r).then(f=>r.getAttribute(u)===f?null:(r.setAttribute(u,f),r));e.push(l)}if(a!==et){let u=Rt(a.key,s,r).then(m=>{let l=r.innerHTML;return a.contentSetter(r,m),l===r.innerHTML?null:r});e.push(u)}r.hasAttribute("data-i18n-tick-time")&&Q().tickElement(r)}return Promise.allSettled(e).then(r=>r.flatMap(n=>n.status==="fulfilled"&&n.value?[n.value]:[]))}async function Rt(t,e,r){for(let n of H(r)){let o=Dt(t,await n.store.translationsFromLanguage(e));if(o.found)return o.translate(e)}return t}var $t={"data-i18n--":1,"data-i18n-attr-":2,"data-i18n-attribute-":3},Wt=/^(data-i18n-(?:attr(?:ibute)?)?-)(.*)$/;function br(t){let e={};for(let r of t.attributes){let{name:n,value:o}=r,a=n.match(Wt);if(!a)continue;let[,s,i]=a,u=e[i];(!u||$t[u.prefix]<$t[s])&&(e[i]={prefix:s,value:o})}return Object.fromEntries(Object.entries(e).map(([r,n])=>[r,n.value]))}var qt=(()=>{function t(n,o){n.textContent=o}function e(n,o){n.innerHTML=o}function r(n,o){n.innerHTML=jt(o).html}return{"data-i18n-unsafe-html":{priority:1,contentSetter:e},"data-i18n-html":{priority:2,contentSetter:r},"data-i18n":{priority:2,contentSetter:t},"data-i18n-text":{priority:3,contentSetter:t}}})(),yr=Object.entries(qt).map(([t,e])=>({...e,attribute:t})).sort((t,e)=>e.priority-t.priority),et=Object.freeze({attribute:"",key:"",priority:0,contentSetter:()=>{}});function vr(t){for(let e of yr){let{attribute:r}=e,n=t.getAttribute(r);if(n!=null)return{...e,key:n}}return et}var Ut={elements:new Set,subtrees:new Set};function xr(){let{elements:t,subtrees:e}=Ut;if(t.size===0&&e.size===0)return;let r=[...e].flatMap(o=>[...o.querySelectorAll("*")]),n=new Set([...t,...r]);t.clear(),e.clear(),rt(n)}var Z;function Tr(t){let{elements:e,subtrees:r}=Ut;for(let n of t){let{target:o,type:a}=n;if(!(o instanceof Element)||a!=="attributes")continue;let{attributeName:s}=n;s&&n.oldValue!==o.getAttribute(s)&&(s==="lang"?(e.add(o),r.add(o)):(Object.hasOwn(qt,s)||s.match(Wt))&&e.add(o))}Z===void 0&&(e.size>0||r.size>0)&&(Z=requestAnimationFrame(()=>{Z=void 0,xr()}))}Q().addCallback(({untick:t,targets:e})=>{let r=e.filter(n=>{let o=n.hasAttribute("data-i18n-tick-time");return o||t(n),o});rt(r)});var kr=new MutationObserver(Tr),wr=Object.freeze({attributes:!0,subtree:!0}),nt=tt;var Sr=new URL(import.meta.url),L=Sr.searchParams.get("named");L&&(customElements.get(L)!=null?console.error(`A custom element with name "${L}" already exists`):customElements.define(L,nt));var Jn=nt;export{Jn as default};
//# sourceMappingURL=i18n.element.min.js.map
